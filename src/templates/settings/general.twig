{% extends "translation-manager/_layouts/settings" %}
{% set title = "General Settings"|t('translation-manager') %}
{% set fullPageForm = true %}
{% set selectedSettingsItem = 'general' %}

{% set plugin = craft.app.plugins.getPlugin('translation-manager') %}
{% set crumbs = [
    {
        label: plugin.settings.pluginName|t('translation-manager'),
        url: url('translation-manager'),
    },
    {
        label: 'Settings'|t('translation-manager'),
        url: url('translation-manager/settings'),
    },
    {
        label: 'General'|t('translation-manager'),
        url: url('translation-manager/settings'),
    },
] %}

{% import "_includes/forms" as forms %}

{% block content %}
	<form method="post" accept-charset="UTF-8">
		{{ csrfInput() }}
		{{ actionInput('translation-manager/settings/save') }}
		{{ redirectInput('translation-manager/settings/general') }}

		<h2 style="margin-top: 0px;">{{ "Plugin Settings"|t('translation-manager') }}</h2>

		{{ forms.textField({
            label: "Plugin Name"|t('translation-manager'),
            instructions: "The display name for the plugin in the Control Panel menu and breadcrumbs"|t('translation-manager'),
            id: 'pluginName',
            name: 'pluginName',
            value: settings.pluginName,
            errors: settings.getErrors('pluginName'),
            required: true,
            disabled: settings.isOverriddenByConfig('pluginName'),
            warning: settings.isOverriddenByConfig('pluginName') ?
                "This is being overridden by the <code>pluginName</code> setting in <code>config/translation-manager.php</code>."|raw : null,
        }) }}

		<hr>

		<h2>{{ "Logging Settings"|t('translation-manager') }}</h2>

		{% set logOptions = [
            {value: 'error', label: 'Error (Critical errors only)'|t('translation-manager')},
            {value: 'warning', label: 'Warning (Errors and warnings)'|t('translation-manager')},
            {value: 'info', label: 'Info (General information)'|t('translation-manager')},
        ] %}

		{% if craft.app.config.general.devMode %}
			{% set logOptions = logOptions|merge([
                {value: 'debug', label: 'Debug (Detailed debugging)'|t('translation-manager')}
            ]) %}
		{% endif %}

		{{ forms.selectField({
            label: 'Log Level'|t('translation-manager'),
            instructions: 'Choose what types of messages to log. Debug level requires devMode to be enabled.'|t('translation-manager'),
            id: 'logLevel',
            name: 'settings[logLevel]',
            value: settings.logLevel,
            options: logOptions,
            disabled: settings.isOverriddenByConfig('logLevel'),
            warning: settings.isOverriddenByConfig('logLevel') ?
                "This is being overridden by the <code>logLevel</code> setting in <code>config/translation-manager.php</code>."|t('translation-manager')|raw : null,
        }) }}

		<div class="buttons">
			<button type="submit" class="btn submit">{{ "Save"|t('translation-manager') }}</button>
		</div>

	</form>

	{% include 'translation-manager/_components/plugin-credit.twig' %}
{% endblock %}
